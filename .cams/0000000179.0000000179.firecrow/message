fleshing in and removing some functions, elliminating index