bunch of stuff around making commit structs, and getting vimdiff to work naievely